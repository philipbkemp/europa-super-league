BEST = {
	supported: [],
	streak: {
		total: {},
		consecutive: {},
		current: {}
	},
	best: {
		for: {},
		against: {},
		win_percent: {},
		goal_difference: {},
		points: {}
	},
	worst: {
		for: {},
		against: {},
		win_percent: {},
		goal_difference: {},
		points: {}
	}	
};

BEST =
{"supported":["uefa","alb","eng","isl"],"streak":{"total":{"uefa":{"value":110,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"liverpool_fc","name":"Liverpool"},"since":"1894-95"}],"clubIds":["liverpool_fc"]},"alb":{"value":80,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"kf_tirana","name":"Tirana"},"since":"1930-31"}],"clubIds":["kf_tirana"]},"eng":{"value":110,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"liverpool_fc","name":"Liverpool"},"since":"1894-95"}],"clubIds":["liverpool_fc"]},"isl":{"value":108,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"since":"1912-13"}],"clubIds":["knattspyrnufelag_reykjavikur"]}},"consecutive":{"uefa":{"value":79,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"start":"1946-47","end":"current season"}],"clubIds":["arsenal_fc"]},"alb":{"value":50,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_vllaznia_shkoder","name":"Vllaznia"},"start":"1968-69","end":"2017-18"}],"clubIds":["fk_vllaznia_shkoder"]},"eng":{"value":79,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"start":"1946-47","end":"current season"}],"clubIds":["arsenal_fc"]},"isl":{"value":46,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"start":"1979-80","end":"current season"},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"start":"1954-55","end":"1999-00"}],"clubIds":["knattspyrnufelag_reykjavikur","valur"]}},"current":{"uefa":{"value":79,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"since":"1946-47"}],"clubIds":["arsenal_fc"]},"alb":{"value":20,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_partizani_tirana","name":"Partizani"},"since":"2001-02"}],"clubIds":["fk_partizani_tirana"]},"eng":{"value":79,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"since":"1946-47"}],"clubIds":["arsenal_fc"]},"isl":{"value":46,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"since":"1979-80"}],"clubIds":["knattspyrnufelag_reykjavikur"]}}},"best":{"for":{"uefa":{"value":5.67,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1933-34"]}],"clubIds":["valur"]},"alb":{"value":5.23,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_partizani_tirana","name":"Partizani"},"seasons":["1951-52"]}],"clubIds":["fk_partizani_tirana"]},"eng":{"value":3.36,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"preston_north_end_fc","name":"Preston North End"},"seasons":["1888-89"]}],"clubIds":["preston_north_end_fc"]},"isl":{"value":5.67,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1933-34"]}],"clubIds":["valur"]}},"against":{"uefa":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1922-23"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1945-46"]}],"clubIds":["knattspyrnufelagio_fram","valur"]},"alb":{"value":0.36,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_partizani_tirana","name":"Partizani"},"seasons":["1954-55"]}],"clubIds":["fk_partizani_tirana"]},"eng":{"value":0.38,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"liverpool_fc","name":"Liverpool"},"seasons":["1978-79"]}],"clubIds":["liverpool_fc"]},"isl":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1922-23"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1945-46"]}],"clubIds":["knattspyrnufelagio_fram","valur"]}},"win_percent":{"uefa":{"value":1,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1915-16","1917-18","1918-19","1921-22","1922-23","1923-24"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"iprottabandalag_akraness","name":"ÍA"},"seasons":["1957-58"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1927-28","1928-29","1931-32","1959-60"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1930-31","1933-34","1937-38","1943-44","1945-46"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1920-21","1924-25"]}],"clubIds":["knattspyrnufelagio_fram","iprottabandalag_akraness","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]},"alb":{"value":0.95,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_partizani_tirana","name":"Partizani"},"seasons":["1954-55"]}],"clubIds":["fk_partizani_tirana"]},"eng":{"value":0.84,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"liverpool_fc","name":"Liverpool"},"seasons":["2019-20"]},{"country":{"id":"eng","name":"England"},"club":{"id":"manchester_city_fc","name":"Manchester City"},"seasons":["2017-18","2018-19"]}],"clubIds":["liverpool_fc","manchester_city_fc"]},"isl":{"value":1,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1915-16","1917-18","1918-19","1921-22","1922-23","1923-24"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"iprottabandalag_akraness","name":"ÍA"},"seasons":["1957-58"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1927-28","1928-29","1931-32","1959-60"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1930-31","1933-34","1937-38","1943-44","1945-46"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1920-21","1924-25"]}],"clubIds":["knattspyrnufelagio_fram","iprottabandalag_akraness","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]}},"goal_difference":{"uefa":{"value":5,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1945-46"]}],"clubIds":["valur"]},"alb":{"value":4.85,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_partizani_tirana","name":"Partizani"},"seasons":["1951-52"]}],"clubIds":["fk_partizani_tirana"]},"eng":{"value":2.68,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"preston_north_end_fc","name":"Preston North End"},"seasons":["1888-89"]}],"clubIds":["preston_north_end_fc"]},"isl":{"value":5,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1945-46"]}],"clubIds":["valur"]}},"points":{"uefa":{"value":3,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1915-16","1917-18","1918-19","1921-22","1922-23","1923-24"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"iprottabandalag_akraness","name":"ÍA"},"seasons":["1957-58"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1927-28","1928-29","1931-32","1959-60"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1930-31","1933-34","1937-38","1943-44","1945-46"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1920-21","1924-25"]}],"clubIds":["knattspyrnufelagio_fram","iprottabandalag_akraness","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]},"alb":{"value":2.91,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_partizani_tirana","name":"Partizani"},"seasons":["1954-55"]}],"clubIds":["fk_partizani_tirana"]},"eng":{"value":2.64,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"preston_north_end_fc","name":"Preston North End"},"seasons":["1888-89"]}],"clubIds":["preston_north_end_fc"]},"isl":{"value":3,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1915-16","1917-18","1918-19","1921-22","1922-23","1923-24"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"iprottabandalag_akraness","name":"ÍA"},"seasons":["1957-58"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1927-28","1928-29","1931-32","1959-60"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1930-31","1933-34","1937-38","1943-44","1945-46"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1920-21","1924-25"]}],"clubIds":["knattspyrnufelagio_fram","iprottabandalag_akraness","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]}}},"worst":{"for":{"uefa":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1927-28"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1919-20"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1933-34"]}],"clubIds":["knattspyrnufelagio_fram","valur","knattspyrnufelagio_vikingur"]},"alb":{"value":0.56,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_vllaznia_shkoder","name":"Vllaznia"},"seasons":["1961-62"]}],"clubIds":["fk_vllaznia_shkoder"]},"eng":{"value":0.68,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"seasons":["1912-13"]}],"clubIds":["arsenal_fc"]},"isl":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1927-28"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1919-20"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1933-34"]}],"clubIds":["knattspyrnufelagio_fram","valur","knattspyrnufelagio_vikingur"]}},"against":{"uefa":{"value":6.25,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1934-35"]}],"clubIds":["knattspyrnufelagio_vikingur"]},"alb":{"value":3.19,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"kf_tirana","name":"Tirana"},"seasons":["1947-48"]}],"clubIds":["kf_tirana"]},"eng":{"value":2.43,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"manchester_city_fc","name":"Manchester City"},"seasons":["1962-63"]}],"clubIds":["manchester_city_fc"]},"isl":{"value":6.25,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1934-35"]}],"clubIds":["knattspyrnufelagio_vikingur"]}},"win_percent":{"uefa":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1920-21","1927-28","1930-31","1931-32","1937-38","1938-39","1940-41","1944-45","1945-46","1948-49","1958-59"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"iprottabandalag_akraness","name":"ÍA"},"seasons":["1946-47","1947-48","1949-50","1950-51"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1916-17","1918-19","1921-22","1922-23","1924-25","1938-39","1957-58"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1915-16","1916-17","1917-18","1919-20","1923-24","1924-25","1925-26","1926-27","1939-40","1952-53"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1922-23","1923-24","1928-29","1930-31","1932-33","1933-34","1934-35","1935-36","1936-37","1944-45","1945-46","1946-47","1947-48","1952-53","1954-55","1956-57"]}],"clubIds":["knattspyrnufelagio_fram","iprottabandalag_akraness","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]},"alb":{"value":0.18,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_vllaznia_shkoder","name":"Vllaznia"},"seasons":["1963-64"]}],"clubIds":["fk_vllaznia_shkoder"]},"eng":{"value":0.08,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"seasons":["1912-13"]}],"clubIds":["arsenal_fc"]},"isl":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1920-21","1927-28","1930-31","1931-32","1937-38","1938-39","1940-41","1944-45","1945-46","1948-49","1958-59"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"iprottabandalag_akraness","name":"ÍA"},"seasons":["1946-47","1947-48","1949-50","1950-51"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1916-17","1918-19","1921-22","1922-23","1924-25","1938-39","1957-58"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1915-16","1916-17","1917-18","1919-20","1923-24","1924-25","1925-26","1926-27","1939-40","1952-53"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1922-23","1923-24","1928-29","1930-31","1932-33","1933-34","1934-35","1935-36","1936-37","1944-45","1945-46","1946-47","1947-48","1952-53","1954-55","1956-57"]}],"clubIds":["knattspyrnufelagio_fram","iprottabandalag_akraness","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]}},"goal_difference":{"uefa":{"value":-5.33,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1933-34","1936-37"]}],"clubIds":["knattspyrnufelagio_vikingur"]},"alb":{"value":-1.56,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"kf_tirana","name":"Tirana"},"seasons":["1947-48"]}],"clubIds":["kf_tirana"]},"eng":{"value":-1.26,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"seasons":["1912-13"]}],"clubIds":["arsenal_fc"]},"isl":{"value":-5.33,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1933-34","1936-37"]}],"clubIds":["knattspyrnufelagio_vikingur"]}},"points":{"uefa":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1920-21","1927-28","1931-32","1937-38"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1918-19","1921-22"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1915-16","1917-18","1919-20","1925-26"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1928-29","1932-33","1933-34","1934-35","1935-36","1936-37","1956-57"]}],"clubIds":["knattspyrnufelagio_fram","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]},"alb":{"value":0.82,"clubs":[{"country":{"id":"alb","name":"Albania"},"club":{"id":"fk_vllaznia_shkoder","name":"Vllaznia"},"seasons":["1963-64"]}],"clubIds":["fk_vllaznia_shkoder"]},"eng":{"value":0.55,"clubs":[{"country":{"id":"eng","name":"England"},"club":{"id":"arsenal_fc","name":"Arsenal"},"seasons":["1912-13"]}],"clubIds":["arsenal_fc"]},"isl":{"value":0,"clubs":[{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_fram","name":"Fram"},"seasons":["1920-21","1927-28","1931-32","1937-38"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelag_reykjavikur","name":"KR"},"seasons":["1918-19","1921-22"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"valur","name":"Valur"},"seasons":["1915-16","1917-18","1919-20","1925-26"]},{"country":{"id":"isl","name":"Iceland"},"club":{"id":"knattspyrnufelagio_vikingur","name":"Vikingur Reykjavik"},"seasons":["1928-29","1932-33","1933-34","1934-35","1935-36","1936-37","1956-57"]}],"clubIds":["knattspyrnufelagio_fram","knattspyrnufelag_reykjavikur","valur","knattspyrnufelagio_vikingur"]}}}}

if ( window.location.href.indexOf("/clubs/") !== -1 ) {
	buildStats();
	compareStats();
} else {
	presentStats();
}

function buildStats() {
	stats = {
		country: {
			id: window.location.href.split("/clubs/")[1].split("/")[0],
			name: document.querySelector("a[href='index.html']").text
		},
		club: {
			id: window.location.href.split("/").pop().split(".")[0],
			name: document.querySelector("h1").innerHTML.split("</span>")[1].split("<")[0].trim()
		},
		streak: {
			total: { value: undefined, first: undefined },
			consecutive: { value: undefined, start: undefined, end: undefined },
			current: { value: undefined, first: undefined }
		},
		best: {
			for: { value: undefined, seasons: [] },
			against: { value: undefined, seasons: [] },
			win_percent: { value: undefined, seasons: [] },
			goal_difference: { value: undefined, seasons: [] },
			points: { value: undefined, seasons: [] }
		},
		worst: {
			for: { value: undefined, seasons: [] },
			against: { value: undefined, seasons: [] },
			win_percent: { value: undefined, seasons: [] },
			goal_difference: { value: undefined, seasons: [] },
			points: { value: undefined, seasons: [] }
		}
	}

	firstYear = 1000;
	secondYear = 1001;

	thisRun = 0;
	thisRunStart = "1000-01";

	Array.from($("#historyTables tbody tr")).forEach(row=>{
		$row = $(row);
		season = $row.find("td a").text();

		yearOne = parseInt(season[0] + season[1] + season[2] + season[3]);
		yearTwo = parseInt(season[0] + season[1] + season[5] + season[6]);
		if ( season[5] === "0" && season[6] === "0" ) {
			yearTwo = yearTwo + 100;
		}
		if ( yearOne+1 !== yearTwo ) {
			console.error("invalid years",season);
		} else if ( yearOne <= firstYear || yearTwo <= secondYear ) {
			console.error("invalid years",season);
		} else if ( yearOne > yearTwo ) {
			console.error("invalid years",season);
		} else {

			if ( typeof(stats.streak.total.value) === "undefined" ) {
				stats.streak.total.value = 1;
				stats.streak.total.first = season;
			} else {
				stats.streak.total.value++;
			}

			if ( thisRunStart === "" ) {
				thisRunStart = season;
			}
			if ( $row.hasClass("removed") ) {
				thisRun++;
				if ( typeof(stats.streak.consecutive.value) === "undefined" || thisRun > stats.streak.consecutive.value ) {
					stats.streak.consecutive.value = thisRun;
					stats.streak.consecutive.start = thisRunStart;
					stats.streak.consecutive.end = season;
					thisRun = 0;
					thisRunStart = "";
				}
			} else {
				thisRun++;
			}

			$cols = $row.find("td");

			if ( $cols.length >= 10 ) {
				forPerGame = parseFloat($cols[10].innerText);
				againstPerGame = parseFloat($cols[11].innerText);
				winPerGame = parseFloat($cols[12].innerText);
				differencePerGame = parseFloat($cols[13].innerText);
				pointsPerGame = parseFloat($cols[14].innerText);
				
				buildHigh(stats.best.for,forPerGame,season);
				buildLow(stats.best.against,againstPerGame,season);
				buildHigh(stats.best.win_percent,winPerGame,season);
				buildHigh(stats.best.goal_difference,differencePerGame,season);
				buildHigh(stats.best.points,pointsPerGame,season);

				buildLow(stats.worst.for,forPerGame,season);
				buildHigh(stats.worst.against,againstPerGame,season);
				buildLow(stats.worst.win_percent,winPerGame,season);
				buildLow(stats.worst.goal_difference,differencePerGame,season);
				buildLow(stats.worst.points,pointsPerGame,season);
			}

		}
	});

	if ( typeof(stats.streak.consecutive.value) === "undefined" || thisRun > stats.streak.consecutive.value ) {
		stats.streak.consecutive.value = thisRun;
		stats.streak.consecutive.start = thisRunStart;
		stats.streak.consecutive.end = "current season";
	}

	if ( typeof(stats.streak.current.value) === "undefined" ) {
		stats.streak.current.value = thisRun;
		stats.streak.current.first = thisRunStart;
	}

	return stats;
}

function buildHigh(stat,incoming,season) {
	if ( typeof(stat.value) === "undefined" || incoming > stat.value ) {
		stat.value = incoming;
		stat.seasons = [season];
	} else if ( incoming === stat.value ) {
		stat.seasons.push(season);
	}
	return stat;
}

function buildLow(stat,incoming,season) {
	if ( typeof(stat.value) === "undefined" || incoming < stat.value ) {
		stat.value = incoming;
		stat.seasons = [season];
	} else if ( incoming === stat.value ) {
		stat.seasons.push(season);
	}
	return stat;
}

function compareStats() {
	changes = false;

	["uefa",stats.country.id].forEach(cid=>{

		if ( ! BEST.supported.includes(cid) ) {
			BEST.supported.push(cid);
			BEST.streak.total[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.streak.consecutive[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.streak.current[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.best.for[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.worst.for[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.best.against[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.worst.against[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.best.win_percent[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.worst.win_percent[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.best.goal_difference[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.worst.goal_difference[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.best.points[cid] = { value: undefined, clubs: [], clubIds: [] };
			BEST.worst.points[cid] = { value: undefined, clubs: [], clubIds: [] };
			changes = true;
		}

		BEST.streak.total[cid] = compareHighest(BEST.streak.total[cid],cid,stats.streak.total,"streak.total",stats.club.id,[{country:stats.country,club:stats.club,since:stats.streak.total.first}]);
		BEST.streak.current[cid] = compareHighest(BEST.streak.current[cid],cid,stats.streak.current,"streak.current",stats.club.id,[{country:stats.country,club:stats.club,since:stats.streak.current.first}]);
		BEST.streak.consecutive[cid] = compareHighest(BEST.streak.consecutive[cid],cid,stats.streak.consecutive,"streak.consecutive",stats.club.id,[{country:stats.country,club:stats.club,start:stats.streak.consecutive.start,end:stats.streak.consecutive.end}]);

		BEST.best.for[cid] = compareHighest(BEST.best.for[cid],cid,stats.best.for,"best.for",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.best.for.seasons}]);
		BEST.best.against[cid] = compareLowest(BEST.best.against[cid],cid,stats.best.against,"best.against",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.best.against.seasons}]);
		BEST.best.win_percent[cid] = compareHighest(BEST.best.win_percent[cid],cid,stats.best.win_percent,"best.win_percent",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.best.win_percent.seasons}]);
		BEST.best.goal_difference[cid] = compareHighest(BEST.best.goal_difference[cid],cid,stats.best.goal_difference,"best.goal_difference",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.best.goal_difference.seasons}]);
		BEST.best.points[cid] = compareHighest(BEST.best.points[cid],cid,stats.best.points,"best.points",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.best.points.seasons}]);

		BEST.worst.for[cid] = compareLowest(BEST.worst.for[cid],cid,stats.worst.for,"worst.for",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.worst.for.seasons}]);
		BEST.worst.against[cid] = compareHighest(BEST.worst.against[cid],cid,stats.worst.against,"worst.against",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.worst.against.seasons}]);
		BEST.worst.win_percent[cid] = compareLowest(BEST.worst.win_percent[cid],cid,stats.worst.win_percent,"worst.win_percent",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.worst.win_percent.seasons}]);
		BEST.worst.goal_difference[cid] = compareLowest(BEST.worst.goal_difference[cid],cid,stats.worst.goal_difference,"worst.goal_difference",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.worst.goal_difference.seasons}]);
		BEST.worst.points[cid] = compareLowest(BEST.worst.points[cid],cid,stats.worst.points,"worst.points",stats.club.id,[{country:stats.country,club:stats.club,seasons:stats.worst.points.seasons}]);

	});

	//console.log(JSON.stringify(BEST));
	//console.log(BEST);
}

function compareHighest(original,cid,incoming,code,clubId,clubData) {
	if ( typeof(original.value) === "undefined" || incoming.value > original.value) {
		original.value = incoming.value;
		original.clubs = clubData;
		original.clubIds = [clubId];
		console.warn("NEW",cid,code);
	} else if ( incoming.value === original.value && ! original.clubIds.includes(clubId)) {
		original.clubs.push(clubData[0]);
		original.clubIds.push(clubId);
		console.warn("UPD",cid,code);
	}

	return original;
}

function compareLowest(original,cid,incoming,code,clubId,clubData) {
	if ( typeof(original.value) === "undefined" || incoming.value < original.value) {
		original.value = incoming.value;
		original.clubs = clubData;
		original.clubIds = [clubId];
		console.warn("NEW",cid,code);
	} else if ( incoming.value === original.value && ! original.clubIds.includes(clubId)) {
		original.clubs.push(clubData[0]);
		original.clubIds.push(clubId);
		console.warn("UPD",cid,code);
	}

	return original;
}

function presentStats() {	
	cid = "uefa";
	queryParams = window.location.search.trim();
	if ( queryParams !== "" ) {
		queryParams = queryParams.split("?")[1].split("&");
		for ( q=0 ; q<queryParams.length ; q++ ) {
			qp = queryParams[q].split("=");
			if ( qp[0] === "country" ) {
				cid = qp[1];
			}
		}
	}
	countryName = $($("a[href$='"+cid+"']")[0]).attr("data-bs-title");
	$("h1").append(": " + countryName);

	$recordsBest = $("#records tbody#best");
	$recordsStreak = $("#records tbody#streak");
	$recordsWorst = $("#records tbody#worst");

	//console.log(BEST);

	buildRow(BEST.streak.total[cid],"Most seasons",$recordsStreak);
	buildRow(BEST.streak.consecutive[cid],"Longest consecutive run",$recordsStreak);
	buildRow(BEST.streak.current[cid],"Longest current run",$recordsStreak);

	buildRow(BEST.best.for[cid],"Best Goals For (per game)",$recordsBest,true);
	buildRow(BEST.best.against[cid],"Best Goals Against (per game)",$recordsBest,true);
	buildRow(BEST.best.win_percent[cid],"Best Win Percentage",$recordsBest,true);
	buildRow(BEST.best.goal_difference[cid],"Best Goal Difference (per game)",$recordsBest,true);
	buildRow(BEST.best.points[cid],"Best Points (per game)",$recordsBest,true);

	buildRow(BEST.worst.for[cid],"Worst Goals For (per game)",$recordsWorst,true);
	buildRow(BEST.worst.against[cid],"Worst Goals Against (per game)",$recordsWorst,true);
	buildRow(BEST.worst.win_percent[cid],"Worst Win Percentage",$recordsWorst,true);
	buildRow(BEST.worst.goal_difference[cid],"Worst Goal Difference (per game)",$recordsWorst,true);
	buildRow(BEST.worst.points[cid],"Worst Points (per game)",$recordsWorst,true);
}

function buildRow(stat,prompt,target,isFloat=false) {
	statValue = stat.value;
	if ( isFloat ) {
		statValue = statValue.toFixed(2);
	}

	$row = $("<TR></TR>");
	$row.append( $("<TH></TH>").attr("scope","row").html(prompt).attr("rowspan",stat.clubIds.length) );
	$row.append( $("<TD></TD>").html(statValue).attr("rowspan",stat.clubIds.length) );
	$row.append( showClub(stat.clubs[0]) );
	target.append($row);
	for ( c=1 ; c!==stat.clubs.length ; c++ ) {
		target.append( $("<TR></TR>").append(showClub(stat.clubs[c])) );
	}
}

function showClub(club) {
	$td = $("<TD></TD>");

	$country = $("<IMG />");
	$country.attr("src","flags/"+club.country.id.toUpperCase()+".png");
	$country.attr("data-bs-toggle","tooltip");
	$country.attr("data-bs-title",club.country.name);
	$country.addClass("me-2");
	$td.append($country);

	$club = $("<A></A>");
	$club.attr("href","clubs/"+club.country.id+"/"+club.club.id+".html");
	$club.html(club.club.name);
	$club.addClass("me-2");
	$td.append($club);

	if ( typeof(club.since) !== "undefined" ) {
		$seasons = $("<SPAN></SPAN>");
		$seasons.addClass("small");
		$seasons.html( "Since " + club.since );
		$td.append($seasons);
	} else if ( typeof(club.start) !== "undefined" ) {
		$seasons = $("<SPAN></SPAN>");
		$seasons.addClass("small");
		$seasons.html( club.start + " to " + club.end );
		$td.append($seasons);
	} else if ( typeof(club.seasons) !== "undefined" ) {
		$seasons = $("<SPAN></SPAN>");
		$seasons.addClass("small");
		$seasons.html( club.seasons.join(", ") );
		$td.append($seasons);
	}

	return $td;
}